<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>OpenMoCo AVR Libraries: OMMoCoBus Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenMoCo AVR Libraries
   </div>
   <div id="projectbrief">Motion Control and MoCoBus Libraries for the AVR Platform</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('class_o_m_mo_co_bus.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">OMMoCoBus Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Core MoCoBus Library.  
 <a href="class_o_m_mo_co_bus.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_o_m_mo_co_bus_8h_source.html">OMMoCoBus.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for OMMoCoBus:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_o_m_mo_co_bus.png" usemap="#OMMoCoBus_map" alt=""/>
  <map id="OMMoCoBus_map" name="OMMoCoBus_map">
<area href="class_o_m_mo_co_master.html" title="MoCoBus Master Library." alt="OMMoCoMaster" shape="rect" coords="0,56,106,80"/>
<area href="class_o_m_mo_co_node.html" title="MoCoBus Node Library." alt="OMMoCoNode" shape="rect" coords="116,56,222,80"/>
<area href="class_o_m_axis.html" alt="OMAxis" shape="rect" coords="0,112,106,136"/>
</map>
 </div></div>

<p><a href="class_o_m_mo_co_bus-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7476d87aa23f904b67a08ab9e02b0469"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_m_mo_co_bus.html#a7476d87aa23f904b67a08ab9e02b0469">OMMoCoBus</a> (HardwareSerial &amp;port, uint8_t, unsigned int mode)</td></tr>
<tr class="memitem:a4e5fd9b0f4adda950d9c0b392216d4a6"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_m_mo_co_bus.html#a4e5fd9b0f4adda950d9c0b392216d4a6">address</a> ()</td></tr>
<tr class="memitem:ab4678ed2fd9d1be4666fc1d43deb7846"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_m_mo_co_bus.html#ab4678ed2fd9d1be4666fc1d43deb7846">address</a> (unsigned int)</td></tr>
<tr class="memitem:ab766533ac99363cb6d92a52357cfb7a1"><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_m_mo_co_bus.html#ab766533ac99363cb6d92a52357cfb7a1">buffer</a> ()</td></tr>
<tr class="memitem:a490368905b48e8318734abe757983cec"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_m_mo_co_bus.html#a490368905b48e8318734abe757983cec">bufferLen</a> ()</td></tr>
<tr class="memitem:a577164df79b2be053269fb0729fce5be"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_m_mo_co_bus.html#a577164df79b2be053269fb0729fce5be">addressCallback</a> (void(*)(uint8_t))</td></tr>
<tr class="memitem:aaa65952427bbd58ab7d0adb31385046a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_m_mo_co_bus.html#aaa65952427bbd58ab7d0adb31385046a">ntoi</a> (uint8_t *)</td></tr>
<tr class="memitem:aed0ede63294aeec46d8f00f5f07e5750"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_m_mo_co_bus.html#aed0ede63294aeec46d8f00f5f07e5750">ntoui</a> (uint8_t *)</td></tr>
<tr class="memitem:a7daaeac1ea6d439f7a700c56eaa9c005"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_m_mo_co_bus.html#a7daaeac1ea6d439f7a700c56eaa9c005">ntol</a> (uint8_t *)</td></tr>
<tr class="memitem:aafbc502bef76d3ff7765e07c6f885eef"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_m_mo_co_bus.html#aafbc502bef76d3ff7765e07c6f885eef">ntoul</a> (uint8_t *)</td></tr>
<tr class="memitem:ac56606c240a631e330e7f0e7a1b3ea94"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_m_mo_co_bus.html#ac56606c240a631e330e7f0e7a1b3ea94">ntof</a> (uint8_t *)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:aa7503c9932e5dd118ac0a003ed729eb7"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_m_mo_co_bus.html#aa7503c9932e5dd118ac0a003ed729eb7">getPacket</a> ()</td></tr>
<tr class="memitem:ad576a49c41682e401f5ffff59b1e2c52"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_m_mo_co_bus.html#ad576a49c41682e401f5ffff59b1e2c52">isBroadcast</a> ()</td></tr>
<tr class="memitem:a01ebebae4c25a561b3aa666bc00c09b4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_m_mo_co_bus.html#a01ebebae4c25a561b3aa666bc00c09b4">sendPacketHeader</a> (unsigned int, uint8_t, uint8_t)</td></tr>
<tr class="memitem:a5762c6450a362153180092b960a57da2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_m_mo_co_bus.html#a5762c6450a362153180092b960a57da2">write</a> (uint8_t)</td></tr>
<tr class="memitem:a93215552a06a6aafe30602fc1bc7d777"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_m_mo_co_bus.html#a93215552a06a6aafe30602fc1bc7d777">write</a> (unsigned int)</td></tr>
<tr class="memitem:a6767bd763ffee1d8cebf8446c2dbc0b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_m_mo_co_bus.html#a6767bd763ffee1d8cebf8446c2dbc0b6">write</a> (int)</td></tr>
<tr class="memitem:a15d46ceea50f3f0c9691842e7ccbd3f0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_m_mo_co_bus.html#a15d46ceea50f3f0c9691842e7ccbd3f0">write</a> (unsigned long)</td></tr>
<tr class="memitem:aae6fb8c97ecb09e25138974e9a6da8ff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_m_mo_co_bus.html#aae6fb8c97ecb09e25138974e9a6da8ff">write</a> (long)</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Core MoCoBus Library. </p>
<p>The Core MoCoBus class provides all the basic capabilities needed for MoCoBus RS-485 masters and nodes using Hardware Serial output to a compatible RS-485 driver.</p>
<p>This class should generally not be used directly in a node or master, instead you should be using the appropriate related class, such as <a class="el" href="class_o_m_mo_co_node.html" title="MoCoBus Node Library.">OMMoCoNode</a>. The Core MoCoBus library is intended for those authoring node and master classes or thosse wishing to port to a different UART interface.</p>
<p>Multiple <a class="el" href="class_o_m_mo_co_bus.html" title="Core MoCoBus Library.">OMMoCoBus</a> objects may exist at the same time, as long as they use different hardware serial objects.</p>
<p><b>Please note: at this time, this library only supports the Atmega328p chipset running with the standard UART and with the DE_PIN wired to digital pin 5. Future versions will add support for different chipsets.</b></p>
<p>This library provides the core protocol handling methods necessary for masters or nodes on a MoCoBus network.</p>
<dl class="section author"><dt>Author:</dt><dd>C. A. Church</dd></dl>
<p>With contributions by Stanislav Perepelitsa</p>
<p>(c) 2011-2012 Dynamic Perception LLC</p>
<p>This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p>
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with this program. If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>. </p>

<p>Definition at line <a class="el" href="_o_m_mo_co_bus_8h_source.html#l00146">146</a> of file <a class="el" href="_o_m_mo_co_bus_8h_source.html">OMMoCoBus.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a7476d87aa23f904b67a08ab9e02b0469"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_m_mo_co_bus.html">OMMoCoBus</a> </td>
          <td>(</td>
          <td class="paramtype">HardwareSerial &amp;&#160;</td>
          <td class="paramname"><em>c_serObj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>c_dePin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>c_dAddr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor</p>
<p>Constructs a new instance of the class. Accepts a hardware serial object, the digital pin # of the transceiver DE/RE pin combination, and the current device address. You may change the address later using <a class="el" href="class_o_m_mo_co_bus.html#a4e5fd9b0f4adda950d9c0b392216d4a6">address()</a></p>
<p>Note: for masters, the address will always be 0, and for slaves the address must be greater than 1.</p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">c_serObj</td><td>An Arduino HardwareSerial object</td></tr>
    <tr><td class="paramname">c_dePin</td><td>The transceiver DE/RE digital I/O pin number</td></tr>
    <tr><td class="paramname">c_dAddr</td><td>The device address </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_o_m_mo_co_bus_8cpp_source.html#l00065">65</a> of file <a class="el" href="_o_m_mo_co_bus_8cpp_source.html">OMMoCoBus.cpp</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a4e5fd9b0f4adda950d9c0b392216d4a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int address </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get Address</p>
<p>Gets the current address assigned to this node.</p>
<dl class="section return"><dt>Returns:</dt><dd>Device address </dd></dl>

<p>Definition at line <a class="el" href="_o_m_mo_co_bus_8cpp_source.html#l00087">87</a> of file <a class="el" href="_o_m_mo_co_bus_8cpp_source.html">OMMoCoBus.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ab4678ed2fd9d1be4666fc1d43deb7846"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void address </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>p_addr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set Address</p>
<p>Sets the current address assigned to this device</p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_addr</td><td>Device address </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="class_o_m_mo_co_master.html#ab4678ed2fd9d1be4666fc1d43deb7846">OMMoCoMaster</a>.</p>

<p>Definition at line <a class="el" href="_o_m_mo_co_bus_8cpp_source.html#l00099">99</a> of file <a class="el" href="_o_m_mo_co_bus_8cpp_source.html">OMMoCoBus.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a577164df79b2be053269fb0729fce5be"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void addressCallback </td>
          <td>(</td>
          <td class="paramtype">void(*)(uint8_t)&#160;</td>
          <td class="paramname"><em>p_Func</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set Address Change Callback</p>
<p>This method sets the callback which will be called whenever an address change occurs. This is highly useful for devices that wish to save their address to EEPROM so that it remains fixed between power cycles, especially when the address change command is received as part of the core MoCoBus protocol.</p>
<p>The callback function pointer passed must accept a single argument of a single byte, which is the new address assigned to the device, and return void.</p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_Func</td><td>A function pointer matching the template void function(byte); </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_o_m_mo_co_bus_8cpp_source.html#l00126">126</a> of file <a class="el" href="_o_m_mo_co_bus_8cpp_source.html">OMMoCoBus.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ab766533ac99363cb6d92a52357cfb7a1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t * buffer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieve Packet Data Buffer</p>
<p>Retrieves the complete packet data buffer (without the packet header) after a packet has been received from the bus.</p>
<p>WARNING: This method returns a pointer to the -actual- buffer. Do not store this pointer between packets or attempt to modify it directly.</p>
<p>Check OM_SER_BUFLEN constant for maximum buffer length.</p>
<dl class="section return"><dt>Returns:</dt><dd>Pointer to packet data buffer </dd></dl>

<p>Definition at line <a class="el" href="_o_m_mo_co_bus_8cpp_source.html#l00495">495</a> of file <a class="el" href="_o_m_mo_co_bus_8cpp_source.html">OMMoCoBus.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a490368905b48e8318734abe757983cec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t bufferLen </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieve Buffer Length</p>
<p>Retrieves the length of data, in bytes, currently stored in the packet data buffer.</p>
<dl class="section return"><dt>Returns:</dt><dd>The length of data, in bytes, in the packet data buffer </dd></dl>

<p>Definition at line <a class="el" href="_o_m_mo_co_bus_8cpp_source.html#l00508">508</a> of file <a class="el" href="_o_m_mo_co_bus_8cpp_source.html">OMMoCoBus.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aa7503c9932e5dd118ac0a003ed729eb7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t getPacket </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get A Packet</p>
<p>Gets a complete packet off of the bus, if available.</p>
<p>If there is a complete packet received over the bus, and if it is destined for this device, this method will place the packet data into the buffer and return the packet code.</p>
<p>Note: this method is not intended for direct use in Nodes, instead see <a class="el" href="class_o_m_mo_co_node.html#a1c69fdbee058f70035fc29a22b53f5a8">OMMoCoNode::check()</a> which is the correct way to check for a received command packet.</p>
<dl class="section return"><dt>Returns:</dt><dd>Packet code, or 0 if not intended for us/error packet </dd></dl>

<p>Definition at line <a class="el" href="_o_m_mo_co_bus_8cpp_source.html#l00147">147</a> of file <a class="el" href="_o_m_mo_co_bus_8cpp_source.html">OMMoCoBus.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad576a49c41682e401f5ffff59b1e2c52"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool isBroadcast </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Received Packet was Broadcast</p>
<p>Call after using <a class="el" href="class_o_m_mo_co_bus.html#aa7503c9932e5dd118ac0a003ed729eb7">getPacket()</a> to determine if the packet received was a broadcast packet.</p>
<p>For example:</p>
<div class="fragment"><div class="line">  uint8_t ret = <a class="code" href="class_o_m_mo_co_bus.html#aa7503c9932e5dd118ac0a003ed729eb7">getPacket</a>();</div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">if</span>( ret != 0 ) {</div>
<div class="line">        <span class="keywordflow">if</span>( <a class="code" href="class_o_m_mo_co_bus.html#ad576a49c41682e401f5ffff59b1e2c52">isBroadcast</a>() == <span class="keyword">true</span> ) {</div>
<div class="line">                <span class="comment">// do something with the broadcast packet</span></div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">                <span class="comment">// directed packet</span></div>
<div class="line">        }</div>
<div class="line">  }</div>
</div><!-- fragment --><dl class="section return"><dt>Returns:</dt><dd>True if the previously received packet was a broadcast packet, false if directed to the specific device. </dd></dl>

<p>Definition at line <a class="el" href="_o_m_mo_co_bus_8cpp_source.html#l00390">390</a> of file <a class="el" href="_o_m_mo_co_bus_8cpp_source.html">OMMoCoBus.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ac56606c240a631e330e7f0e7a1b3ea94"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ntof </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>p_dat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert Network-order Bytes to Float</p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_dat</td><td>A pointer to an array of bytes</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>A float </dd></dl>

<p>Definition at line <a class="el" href="_o_m_mo_co_bus_8cpp_source.html#l00688">688</a> of file <a class="el" href="_o_m_mo_co_bus_8cpp_source.html">OMMoCoBus.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aaa65952427bbd58ab7d0adb31385046a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ntoi </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>p_dat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert Network-order Bytes to Integer</p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_dat</td><td>A pointer to an array of bytes</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>A signed integer </dd></dl>

<p>Definition at line <a class="el" href="_o_m_mo_co_bus_8cpp_source.html#l00630">630</a> of file <a class="el" href="_o_m_mo_co_bus_8cpp_source.html">OMMoCoBus.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a7daaeac1ea6d439f7a700c56eaa9c005"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long ntol </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>p_dat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert Network-order Bytes to Long</p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_dat</td><td>A pointer to an array of bytes</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>A long </dd></dl>

<p>Definition at line <a class="el" href="_o_m_mo_co_bus_8cpp_source.html#l00673">673</a> of file <a class="el" href="_o_m_mo_co_bus_8cpp_source.html">OMMoCoBus.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aed0ede63294aeec46d8f00f5f07e5750"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int ntoui </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>p_dat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert Network-order Bytes to Unsigned Integer</p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_dat</td><td>A pointer to an array of bytes</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>An unsigned integer </dd></dl>

<p>Definition at line <a class="el" href="_o_m_mo_co_bus_8cpp_source.html#l00644">644</a> of file <a class="el" href="_o_m_mo_co_bus_8cpp_source.html">OMMoCoBus.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aafbc502bef76d3ff7765e07c6f885eef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long ntoul </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>p_dat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert Network-order Bytes to Unsigned Long</p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_dat</td><td>A pointer to an array of bytes</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>An unsigned long </dd></dl>

<p>Definition at line <a class="el" href="_o_m_mo_co_bus_8cpp_source.html#l00658">658</a> of file <a class="el" href="_o_m_mo_co_bus_8cpp_source.html">OMMoCoBus.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a01ebebae4c25a561b3aa666bc00c09b4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sendPacketHeader </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>p_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>p_code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>p_dlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Send Packet Header</p>
<p>Sends a complete packet header, given an address to target, a packet code to ssend, and the length of data that will be sent.</p>
<p>This method is part of a low-level toolkit for creating MoCoBus handlers, and should not be used in part of a normal Node implementation. Instead, see <a class="el" href="class_o_m_mo_co_node.html#ae83ba323f19fde07537d82792cb21a4d">OMMoCoNode::response()</a>.</p>
<p>If you send a packet header to the broadcast address (as defined by OM_SER_BCAST_ADDR), the method <a class="el" href="class_o_m_mo_co_bus.html#ad576a49c41682e401f5ffff59b1e2c52">isBroadcast()</a> will return true immediately after calling this method. You can use this in higher-level classes to determine if a response should be expected.</p>
<p>A MoCoBus packet always starts with a 10-byte header with the following structure:</p>
<table  border="1" width="80%">
<tr>
<td>0 </td><td>1 </td><td>2 </td><td>3 </td><td>4 </td><td>5 </td><td>6 </td><td>7 </td><td>8 </td><td>9  </td></tr>
<tr>
<td colspan="6"><b>Break Sequence</b> </td><td colspan="2"><b>Address</b> </td><td><b>Packet Code</b> </td><td><b>Data Len</b>  </td></tr>
<tr>
<td>0 </td><td>0 </td><td>0 </td><td>0 </td><td>0 </td><td>255 </td><td colspan="2">0-65535 </td><td>0-255 </td><td>0-255  </td></tr>
</table>
<p>Note that all multi-byte values sent using the MoCoBus specification are in Big-Endian (Network) byte order!</p>
<p>There are two types of packets which may be sent on MoCoBus, and they are not differentiated except in the order in which they occur:</p>
<p>Command Packet</p>
<p>A command packet is sent by a Master, and may have up to 254 packet codes, from 1-255. 0 is never a valid packet code for a command packet. Up to 255 data bytes may be included with the packet, as long as they do not include a sequence which corresponds to the break sequence noted above.</p>
<p>Generally speaking, due to the limitation of 254 packet codes, the protocol for a specific node type will likely define a series of sub-codes for use as the first byte or set of bytes in the packet data.</p>
<p>Response Packet</p>
<p>A response packet is sent by a Node, in response to a command packet, back to the master. It should only have two valid packet codes: 0 and 1, with 0 indicating an error occured processing the command and 1 indicating that the command was successfully completed. Response packets may or may not contain actual packet data, this will depend on the specific implementation by the node.</p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_addr</td><td>The device address to ssend the packet header to</td></tr>
    <tr><td class="paramname">p_code</td><td>The packet code to use</td></tr>
    <tr><td class="paramname">p_dlen</td><td>The packet data length, in bytes </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_o_m_mo_co_bus_8cpp_source.html#l00339">339</a> of file <a class="el" href="_o_m_mo_co_bus_8cpp_source.html">OMMoCoBus.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a5762c6450a362153180092b960a57da2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void write </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>p_dat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Write Data to Bus</p>
<p>Writes packet data to the bus, should only ever be used after <a class="el" href="class_o_m_mo_co_bus.html#a01ebebae4c25a561b3aa666bc00c09b4">sendPacketHeader()</a>. </p>

<p>Definition at line <a class="el" href="_o_m_mo_co_bus_8cpp_source.html#l00401">401</a> of file <a class="el" href="_o_m_mo_co_bus_8cpp_source.html">OMMoCoBus.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a93215552a06a6aafe30602fc1bc7d777"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void write </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>p_dat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Write Data to Bus</p>
<p>Writes packet data to the bus, should only ever be used after <a class="el" href="class_o_m_mo_co_bus.html#a01ebebae4c25a561b3aa666bc00c09b4">sendPacketHeader()</a>. </p>

<p>Definition at line <a class="el" href="_o_m_mo_co_bus_8cpp_source.html#l00430">430</a> of file <a class="el" href="_o_m_mo_co_bus_8cpp_source.html">OMMoCoBus.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a6767bd763ffee1d8cebf8446c2dbc0b6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void write </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>p_dat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Write Data to Bus</p>
<p>Writes packet data to the bus, should only ever be used after <a class="el" href="class_o_m_mo_co_bus.html#a01ebebae4c25a561b3aa666bc00c09b4">sendPacketHeader()</a>. </p>

<p>Definition at line <a class="el" href="_o_m_mo_co_bus_8cpp_source.html#l00443">443</a> of file <a class="el" href="_o_m_mo_co_bus_8cpp_source.html">OMMoCoBus.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a15d46ceea50f3f0c9691842e7ccbd3f0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void write </td>
          <td>(</td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>p_dat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Write Data to Bus</p>
<p>Writes packet data to the bus, should only ever be used after <a class="el" href="class_o_m_mo_co_bus.html#a01ebebae4c25a561b3aa666bc00c09b4">sendPacketHeader()</a>. </p>

<p>Definition at line <a class="el" href="_o_m_mo_co_bus_8cpp_source.html#l00456">456</a> of file <a class="el" href="_o_m_mo_co_bus_8cpp_source.html">OMMoCoBus.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aae6fb8c97ecb09e25138974e9a6da8ff"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void write </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>p_dat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Write Data to Bus</p>
<p>Writes packet data to the bus, should only ever be used after <a class="el" href="class_o_m_mo_co_bus.html#a01ebebae4c25a561b3aa666bc00c09b4">sendPacketHeader()</a>. </p>

<p>Definition at line <a class="el" href="_o_m_mo_co_bus_8cpp_source.html#l00471">471</a> of file <a class="el" href="_o_m_mo_co_bus_8cpp_source.html">OMMoCoBus.cpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_o_m_mo_co_bus_8h_source.html">OMMoCoBus.h</a></li>
<li><a class="el" href="_o_m_mo_co_bus_8cpp_source.html">OMMoCoBus.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="class_o_m_mo_co_bus.html">OMMoCoBus</a></li>
    <li class="footer">Generated on Sun Jun 17 2012 13:59:32 for OpenMoCo AVR Libraries by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1.1 </li>
  </ul>
</div>
</body>
</html>
